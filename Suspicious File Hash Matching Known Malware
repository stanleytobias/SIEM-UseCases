Suspicious File Hash Matching Known Malware

MITRE ATT&CK Mapping:
Tactic: Execution (TA0002)
Technique: User Execution (T1204.001)

Detection Logic:
Detect file hashes matching known malware.

Microsoft Sentinel KQL Query:
FileAuditLogs
| join kind=inner (ThreatIntelligenceIndicator | where IndicatorType == "FileHash") on $left.FileHash == $right.Indicator
| project TimeGenerated, FileName, FileHash, Indicator

Testing:
Deploy a benign file with a known flagged hash.
