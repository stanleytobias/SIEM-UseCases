Malware Callback Detection

MITRE ATT&CK Mapping:
Tactic: Command and Control (TA0011)
Technique: Application Layer Protocol (T1071)

Detection Logic:
Detect traffic to known malicious IPs or domains often used by malware for callbacks.

Microsoft Sentinel KQL Query:
NetworkTraffic
| where DestinationIP in (maliciousIPs) or DestinationDomain in (maliciousDomains)
| summarize CallbackCount = count() by SourceIP, DestinationIP, DestinationDomain, bin(TimeGenerated, 1h)
| project TimeGenerated, SourceIP, DestinationIP, DestinationDomain, CallbackCount

Testing:
Simulate traffic to known malicious or test domains using tools like curl.
